{** $currentPeriod cashReportDdsServicePeriod **}
{** $reportPeriods cashReportDdsServicePeriod[] **}
{** $type cashReportDdsServiceTypeDto **}
{** $grouping cashReportDdsServicePeriodGroupingDto[] **}
{** $data cashReportDdsServiceStatDto[] **}

<script src="{$wa_app_static_url}js/amcharts/core.js"></script>
<script src="{$wa_app_static_url}js/amcharts/charts.js"></script>
<script src="{$wa_app_static_url}js/amcharts/themes/animated.js"></script>
{if $wa->locale() !== 'en_US'}
<script src="{$wa_app_static_url}js/amcharts/lang/{$wa->locale()}.js"></script>
{/if}
<script type="module">
    import reportCategories from "{$wa_app_static_url}js/reports/reportCategories.js";
    const data = {$chartData};
    reportCategories(data);
</script>

<div class="block">

    <h1>[`Categories`]</h1>

    <div class="flexbox middle">
        <ul class="chips custom-m-0">
            <li>
                <div class="dropdown" id="c-dds-year-dropdown">
                    <button class="dropdown-toggle custom-mr-16">{$currentPeriod->getName()}</button>
                    <div class="dropdown-body">
                        <ul class="menu" style="min-width: 100px;">
                            {foreach array_reverse($reportPeriods) as $reportPeriod}
                            <li {if $currentPeriod->isEqual($reportPeriod)}class="selected"{/if}>
                                <a href="{$wa_app_url}report/categories/year={$reportPeriod->getValue()}"
                                data-cash-period-value="{$reportPeriod->getValue()}"
                                data-cash-period-start="{$reportPeriod->getStartDate()}"
                                data-cash-period-end="{$reportPeriod->getEndDate()}"
                                class="{if $reportPeriod->getValue() > $smarty.now|date_format:'Y'}opacity-50{/if} {if $reportPeriod->getValue() == $smarty.now|date_format:'Y'}bold{/if}"
                                >
                                    {$reportPeriod->getName()|escape}
                                </a>
                            </li>
                            {/foreach}
                        </ul>
                    </div>
             ***REMOVED***
                        ( function($) {
                            $("#c-dds-year-dropdown").waDropdown();
                        })(jQuery);
             ***REMOVED***
                </div>
            </li>
        </ul>
        <div class="currencies-container toggle" style="display: none;"></div>
    </div>

    <input type="hidden" value="{$type->id}" name="dds[type]"/>

    <br>

    {$_data_inc = []}
    {$_data_exp = []}
    {foreach $data as $d}
        {if $d->entity->isExpense()}{$_data_exp[] = $d}{/if}
        {if $d->entity->isIncome()}{$_data_inc[] = $d}{/if}
    {/foreach}

    <div class="flexbox custom-mb-40">
        <div class="c-charts width-50" style="display: none;">
            <div class="align-center bold">[`Income`]</div>
            <div id="chartdiv_income" style="width: 100%;height: 400px;"></div>
        </div>
        <div class="c-charts width-50" style="display: none;">
            <div class="align-center bold">[`Expense`]</div>
            <div id="chartdiv_expense" style="width: 100%;height: 400px;"></div>
        </div>
    </div>
    
    <div id="cols" class="flexbox" style="flex-wrap: wrap;"></div>
    
</div>



